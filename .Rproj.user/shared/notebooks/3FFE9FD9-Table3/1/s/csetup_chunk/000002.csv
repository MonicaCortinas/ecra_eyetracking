"0",""
"0","knitr::opts_chunk$set(message = FALSE, warning = FALSE)"
"0","# Lectura de datos"
"0","basecompleta<- read.csv(file=""data/basecompleta.csv"", header = TRUE,"
"0","                        sep = ""\t"" , encoding = ""UTF-8"")"
"0","## QUALTRICS"
"0","dataindividuo <- read.csv(file=""data/baseindividuo.csv"", header = TRUE,"
"0","                          sep = ""\t"" , encoding = ""UTF-8"")"
"0","dataset<-dataindividuo"
"0","dataset$sexo<- dataindividuo$Sexo"
"0","dataset$sexo = factor(dataset$sexo, levels = c(""Mujer"", ""Hombre""))"
"0",""
"0","dataset$edad<- dataindividuo$Edad"
"0",""
"0","dataset$educacion<- dataindividuo[,99]"
"0","dataset$educacion<- factor(dataset$educacion, levels = c(""EnseÃ±anza secundaria (BUP/Bachillerato/FP)"", "
"0","                                                         ""Estudios universitarios"", ""Master""))"
"0",""
"0","dataset$ocupacion<- dataindividuo[,100]"
"0","dataset$ocupacion<- factor(dataset$ocupacion, levels = c(""Estudiante"", "
"0","                                                         ""Parado"", ""Trabaja por cuenta ajena""))"
"0","dataset$buscaonline<-dataindividuo[,95]"
"0","dataset$compraonline<-dataindividuo[,96]"
"0",""
"0","# FACTORIALES"
"0",""
"0","library(nFactors)"
"0",""
"0","implizapa<- dataindividuo[,c(""ConoZapatillas"",""impliZapatillas"",""interZapatillas"")]"
"0","d<-factanal(implizapa, factors=1)"
"0","a1<-psych::alpha(implizapa)"
"0","dataindividuo$consImZapa<- d$loadings[1,]*dataindividuo$ConoZapatillas +d$loadings[2,]*dataindividuo$impliZapatillas+d$loadings[3,]*dataindividuo$impliZapatillas"
"0",""
"0","impliTele<- dataindividuo[,c(""ConoTelefonos"",""impliTelefonos"",""interTelefonos"")]"
"0","d<-factanal(impliTele, factors=1)"
"0","a2<-psych::alpha(impliTele)"
"0","dataindividuo$consImTele<- d$loadings[1,]*dataindividuo$ConoTelefonos +d$loadings[2,]*dataindividuo$impliTelefonos+d$loadings[3,]*dataindividuo$interTelefonos"
"0",""
"0","implibolis<- dataindividuo[,c(""Conobolis"",""implibolis"",""interbolis"")]"
"0","d<-factanal(implibolis, factors=1)"
"0","a3<-psych::alpha(implibolis)"
"0","dataindividuo$consImBolis<- d$loadings[1,]*dataindividuo$Conobolis +d$loadings[2,]*dataindividuo$implibolis+d$loadings[3,]*dataindividuo$interbolis"
"0",""
"0","impliHDs<- dataindividuo[,c(""ConoHDs"",""impliHDs"",""interHDs"")]"
"0","a4<-psych::alpha(impliHDs)"
"0","d<-factanal(impliHDs, factors=1)"
"0","dataindividuo$consImHDs<- d$loadings[1,]*dataindividuo$ConoHDs +d$loadings[2,]*dataindividuo$impliHDs+d$loadings[3,]*dataindividuo$interHDs"
"0",""
"0",""
"0",""
"0","#### Tiempos en cada web"
"0",""
"0","# Nuevo data frame:"
"0","#sec/n/Task/Cat"
"0",""
"0","DataBase<- data.frame(dataindividuo$n,""ID""=dataindividuo$ID, ""secZapa""= dataindividuo$secZapa, ""secTele""=dataindividuo$secTele, ""secBoli""=dataindividuo$secBoli, ""secHd""=dataindividuo$secHd, dataindividuo$Task1, dataindividuo$Task2, dataindividuo$Task3, dataindividuo$Task4, ""busca""=dataindividuo[,95], ""compra""=dataindividuo[,96], dataindividuo$ConoZapatillas, dataindividuo$ConoTelefonos, dataindividuo$Conobolis, dataindividuo$ConoHDs,dataindividuo$impliZapatillas, dataindividuo$impliTelefonos, dataindividuo$implibolis, dataindividuo$impliHDs, dataindividuo$interZapatillas, dataindividuo$interTelefonos, dataindividuo$interbolis, dataindividuo$interHDs, dataindividuo$precioZapatillas, dataindividuo$marcaZapatillas, dataindividuo$pagoZapatillas, dataindividuo$devolZapatillas, dataindividuo$envioZapatillas, dataindividuo$seguiZapatillas, dataindividuo$precioTelefonos, dataindividuo$marcaTelefonos, dataindividuo$pagoTelefonos, dataindividuo$devolTelefonos, dataindividuo$envioTelefonos, dataindividuo$seguiTelefonos, dataindividuo$preciobolis, dataindividuo$marcabolis, dataindividuo$pagobolis, dataindividuo$devolbolis, dataindividuo$enviobolis, dataindividuo$seguibolis, dataindividuo$precioHDs, dataindividuo$marcaHDs, dataindividuo$pagoHDs, dataindividuo$devolHDs, dataindividuo$envioHDs, dataindividuo$seguiHDs,   dataindividuo$consImZapa, dataindividuo$consImZapa , dataindividuo$consImTele, dataindividuo$consImBolis, dataindividuo$consImHDs       )"
"0",""
"0","# Make sure the subject column is a factor"
"0","DataBase$dataindividuo.n <- factor(DataBase$dataindividuo.n)"
"0",""
"0","library(tidyr)"
"0",""
"0",""
"0",""
"0","LongDat <- gather(DataBase, category, seconds, secZapa:secHd)"
"0",""
"0","LongDat$Task[LongDat$category==""secZapa""]<-1"
"0","LongDat$Task[LongDat$category==""secTele""]<-2"
"0","LongDat$Task[LongDat$category==""secBoli""]<-3"
"0","LongDat$Task[LongDat$category==""secHd""]<-4"
"0",""
"0","LongDat$IMPGlobal[LongDat$category==""secZapa""]<-LongDat$dataindividuo.consImZapa[LongDat$category==""secZapa""]"
"0","LongDat$IMPGlobal[LongDat$category==""secTele""]<-LongDat$dataindividuo.consImTele[LongDat$category==""secTele""]"
"0","LongDat$IMPGlobal[LongDat$category==""secBoli""]<-LongDat$dataindividuo.consImBolis[LongDat$category==""secBoli""]"
"0","LongDat$IMPGlobal[LongDat$category==""secHd""]<-LongDat$dataindividuo.consImHDs[LongDat$category==""secBoli""]"
"0",""
"0","LongDat$Conoc[LongDat$category==""secZapa""]<-LongDat$dataindividuo.ConoZapatillas[LongDat$category==""secZapa""]"
"0","LongDat$Conoc[LongDat$category==""secTele""]<-LongDat$dataindividuo.ConoTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Conoc[LongDat$category==""secBoli""]<-LongDat$dataindividuo.Conobolis[LongDat$category==""secBoli""]"
"0","LongDat$Conoc[LongDat$category==""secHd""]<-LongDat$dataindividuo.ConoHDs[LongDat$category==""secBoli""]"
"0",""
"0","LongDat$Impli[LongDat$category==""secZapa""]<-LongDat$dataindividuo.impliZapatillas[LongDat$category==""secZapa""]"
"0","LongDat$Impli[LongDat$category==""secTele""]<-LongDat$dataindividuo.impliTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Impli[LongDat$category==""secBoli""]<-LongDat$dataindividuo.implibolis[LongDat$category==""secBoli""]"
"0","LongDat$Impli[LongDat$category==""secHd""]<-LongDat$dataindividuo.impliHDs[LongDat$category==""secBoli""]"
"0",""
"0","LongDat$Interes[LongDat$category==""secZapa""]<-LongDat$dataindividuo.interZapatillas[LongDat$category==""secZapa""]"
"0","LongDat$Interes[LongDat$category==""secTele""]<-LongDat$dataindividuo.interTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Interes[LongDat$category==""secBoli""]<-LongDat$dataindividuo.interbolis[LongDat$category==""secBoli""]"
"0","LongDat$Interes[LongDat$category==""secHd""]<-LongDat$dataindividuo.interHDs[LongDat$category==""secBoli""]"
"0",""
"0","LongDat$Marca[LongDat$category==""secZapa""]<-LongDat$dataindividuo.marcaZapatillas[LongDat$category==""secZapa""]"
"0","LongDat$Marca[LongDat$category==""secTele""]<-LongDat$dataindividuo.marcaTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Marca[LongDat$category==""secBoli""]<-LongDat$dataindividuo.marcabolis[LongDat$category==""secBoli""]"
"0","LongDat$Marca[LongDat$category==""secHd""]<-LongDat$dataindividuo.marcaHDs[LongDat$category==""secBoli""]"
"0",""
"0","LongDat$Precio[LongDat$category==""secZapa""]<-LongDat$dataindividuo.precioZapatillas[LongDat$category==""secZapa""]"
"0","LongDat$Precio[LongDat$category==""secTele""]<-LongDat$dataindividuo.precioTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Precio[LongDat$category==""secBoli""]<-LongDat$dataindividuo.preciobolis[LongDat$category==""secBoli""]"
"0","LongDat$Precio[LongDat$category==""secHd""]<-LongDat$dataindividuo.precioHDs[LongDat$category==""secBoli""]"
"0",""
"0","LongDat$Devol[LongDat$category==""secZapa""]<-LongDat$dataindividuo.devolZapatillas[LongDat$category==""secZapa""]"
"0","LongDat$Devol[LongDat$category==""secTele""]<-LongDat$dataindividuo.devolTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Devol[LongDat$category==""secBoli""]<-LongDat$dataindividuo.devolbolis[LongDat$category==""secBoli""]"
"0","LongDat$Devol[LongDat$category==""secHd""]<-LongDat$dataindividuo.devolHDs[LongDat$category==""secBoli""]"
"0",""
"0","LongDat$Envio[LongDat$category==""secZapa""]<-LongDat$dataindividuo.envioZapatillas[LongDat$category==""secZapa""]"
"0","LongDat$Envio[LongDat$category==""secTele""]<-LongDat$dataindividuo.envioTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Envio[LongDat$category==""secBoli""]<-LongDat$dataindividuo.enviobolis[LongDat$category==""secBoli""]"
"0","LongDat$Envio[LongDat$category==""secHd""]<-LongDat$dataindividuo.envioHDs[LongDat$category==""secBoli""]"
"0",""
"0",""
"0","LongDat$Segui[LongDat$category==""secZapa""]<-LongDat$dataindividuo.seguiZapatillas[LongDat$category==""secZapa""]"
"0","LongDat$Segui[LongDat$category==""secTele""]<-LongDat$dataindividuo.seguiTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Segui[LongDat$category==""secHd""]<-LongDat$dataindividuo.seguiHDs[LongDat$category==""secBoli""]"
"0","LongDat$Pago[LongDat$category==""secTele""]<-LongDat$dataindividuo.pagoTelefonos[LongDat$category==""secTele""]"
"0","LongDat$Pago[LongDat$category==""secBoli""]<-LongDat$dataindividuo.pagobolis[LongDat$category==""secBoli""]"
"0","LongDat$Pago[LongDat$category==""secHd""]<-LongDat$dataindividuo.pagoHDs[LongDat$category==""secBoli""]"
"0",""
"0",""
"0","LongDat$Asignada[LongDat$Task==1]<-as.character(LongDat$dataindividuo.Task1[LongDat$Task==1])"
"0","LongDat$Asignada[LongDat$Task==2]<-as.character(LongDat$dataindividuo.Task2[LongDat$Task==2])"
"0","LongDat$Asignada[LongDat$Task==3]<-as.character(LongDat$dataindividuo.Task3[LongDat$Task==3])"
"0","LongDat$Asignada[LongDat$Task==4]<-as.character(LongDat$dataindividuo.Task4[LongDat$Task==4])"
"0",""
"0","LongDat$Asignada<- factor(LongDat$Asignada, levels=c(""explor"", ""search"", ""purchase"", ""post"" ))"
"0","LongDat$category<- factor(LongDat$category, levels=c(""secZapa"", ""secTele"", ""secBoli"", ""secHd""))"
"0",""
"0",""
"0",""
"0","# Creamos las variables que identifican a las areas:"
"0",""
"0","basecompleta$Tzona<- basecompleta$zona"
"0","basecompleta$Tzona<- 0"
"0","basecompleta$Tzona[basecompleta$zona==1]<-""A"""
"0","basecompleta$Tzona[basecompleta$zona==2]<-""A"""
"0",""
"0","basecompleta$Tzona[basecompleta$zona==3]<-""B"""
"0","basecompleta$Tzona[basecompleta$zona==4]<-""B"""
"0","basecompleta$Tzona[basecompleta$zona==5]<-""B"""
"0","basecompleta$Tzona[basecompleta$zona==6]<-""B"""
"0",""
"0",""
"0","basecompleta$Tzona[(basecompleta$zona>10)&(basecompleta$zona<90)]<-""C"""
"0",""
"0",""
"0",""
"0","# Eliminamos los perdidos"
"0",""
"0","basecompleta$Fixa1 <-basecompleta$fixa1"
"0","basecompleta$Fixa1[basecompleta$Fixa1==""Inf""]<-0"
"0","basecompleta$Fixa1[is.na(basecompleta$Fixa1)]<-0"
"0",""
"0","#la variable sumFixa1 es las fijaciones totales en esa zona. "
"0",""
"0",""
"0","basecompleta$sumFixa1 <-basecompleta$sumFixa1"
"0","basecompleta$sumFixa1[basecompleta$sumFixa1==""Inf""]<-0"
"0","basecompleta$sumFixa1[is.na(basecompleta$sumFixa1)]<-0"
"0",""
"0","basecompleta$Fixa2 <- basecompleta$fixa2"
"0","basecompleta$Fixa2[basecompleta$Fixa2==""Inf""]<-0"
"0","basecompleta$Fixa2[is.na(basecompleta$Fixa2)]<-0"
"0",""
"0","basecompleta$sumFixa2 <- basecompleta$sumFixa2"
"0","basecompleta$sumFixa2[basecompleta$sumFixa2==""Inf""]<-0"
"0","basecompleta$sumFixa2[is.na(basecompleta$sumFixa2)]<-0"
"0",""
"0","basecompleta$Fixa3 <- basecompleta$fixa3"
"0","basecompleta$Fixa3[basecompleta$Fixa3==""Inf""]<-0"
"0","basecompleta$Fixa3[is.na(basecompleta$Fixa3)]<-0"
"0",""
"0","basecompleta$sumFixa3 <- basecompleta$sumFixa3"
"0","basecompleta$sumFixa3[basecompleta$sumFixa3==""Inf""]<-0"
"0","basecompleta$sumFixa3[is.na(basecompleta$sumFixa3)]<-0"
"0",""
"0","basecompleta$Fixa4 <- basecompleta$fixa4"
"0","basecompleta$Fixa4[basecompleta$Fixa4==""Inf""]<-0"
"0","basecompleta$Fixa4[is.na(basecompleta$Fixa4)]<-0"
"0",""
"0","basecompleta$sumFixa4 <- basecompleta$sumFixa4"
"0","basecompleta$sumFixa4[basecompleta$sumFixa4==""Inf""]<-0"
"0","basecompleta$sumFixa4[is.na(basecompleta$sumFixa4)]<-0"
"0",""
"0",""
"0","# Area zona 1:"
"0",""
"0","areazonaA<- 226301.63"
"0","areazonaB<- 124301.25  "
"0","areazonaC_1<-372720.10 "
"0","areazonaC_2<-376167.02 "
"0","areazonaC_3<-372720.10"
"0","areazonaC_4<-375592.53 "
"0",""
"0",""
"0","poraA1<-areazonaA/(areazonaA+areazonaB+areazonaC_1)"
"0","poraA2<-areazonaA/(areazonaA+areazonaB+areazonaC_2)"
"0","poraA3<-areazonaA/(areazonaA+areazonaB+areazonaC_3)"
"0","poraA4<-areazonaA/(areazonaA+areazonaB+areazonaC_4)"
"0",""
"0","poraB1<-areazonaB/(areazonaA+areazonaB+areazonaC_1)"
"0","poraB2<-areazonaB/(areazonaA+areazonaB+areazonaC_2)"
"0","poraB3<-areazonaB/(areazonaA+areazonaB+areazonaC_3)"
"0","poraB4<-areazonaB/(areazonaA+areazonaB+areazonaC_4)"
"0",""
"0","poraC1<-areazonaC_1/(areazonaA+areazonaB+areazonaC_1)"
"0","poraC2<-areazonaC_2/(areazonaA+areazonaB+areazonaC_2)"
"0","poraC3<-areazonaC_3/(areazonaA+areazonaB+areazonaC_3)"
"0","poraC4<-areazonaC_4/(areazonaA+areazonaB+areazonaC_4)"
"0","# Con estas fijaciones totales por area trabajamos en las bases agregadas:"
"0",""
"0","df_fixa <- aggregate(cbind(Fixa1, Fixa2, Fixa3, Fixa4) ~ ID + Tzona, data = basecompleta, sum, na.rm = TRUE)"
"0",""
"0","df_fixa$Fixa1_por[df_fixa$Tzona==""A""]=df_fixa$Fixa1[df_fixa$Tzona==""A""]*poraA1"
"0","df_fixa$Fixa1_por[df_fixa$Tzona==""B""]=df_fixa$Fixa1[df_fixa$Tzona==""B""]*poraB1"
"0","df_fixa$Fixa1_por[df_fixa$Tzona==""C""]=df_fixa$Fixa1[df_fixa$Tzona==""C""]*poraC1"
"0",""
"0","df_fixa$Fixa2_por[df_fixa$Tzona==""A""]=df_fixa$Fixa2[df_fixa$Tzona==""A""]*poraA2"
"0","df_fixa$Fixa2_por[df_fixa$Tzona==""B""]=df_fixa$Fixa2[df_fixa$Tzona==""B""]*poraB2"
"0","df_fixa$Fixa2_por[df_fixa$Tzona==""C""]=df_fixa$Fixa2[df_fixa$Tzona==""C""]*poraC2"
"0",""
"0","df_fixa$Fixa3_por[df_fixa$Tzona==""A""]=df_fixa$Fixa3[df_fixa$Tzona==""A""]*poraA3"
"0","df_fixa$Fixa3_por[df_fixa$Tzona==""B""]=df_fixa$Fixa3[df_fixa$Tzona==""B""]*poraB3"
"0","df_fixa$Fixa3_por[df_fixa$Tzona==""C""]=df_fixa$Fixa3[df_fixa$Tzona==""C""]*poraC3"
"0",""
"0","df_fixa$Fixa4_por[df_fixa$Tzona==""A""]=df_fixa$Fixa4[df_fixa$Tzona==""A""]*poraA4"
"0","df_fixa$Fixa4_por[df_fixa$Tzona==""B""]=df_fixa$Fixa4[df_fixa$Tzona==""B""]*poraB4"
"0","df_fixa$Fixa4_por[df_fixa$Tzona==""C""]=df_fixa$Fixa4[df_fixa$Tzona==""C""]*poraC4"
"0",""
"0",""
"0",""
"0","# La que nos interesa es la que tiene las agregadas:"
"0",""
"0",""
"0","df_sumFixa <- aggregate(cbind(sumFixa1, sumFixa2, sumFixa3, sumFixa4) ~ ID + Tzona, data = basecompleta, sum, na.rm = TRUE)"
"0",""
"0",""
"0",""
"0","df_sumFixa$sumFixa1_por[df_sumFixa$Tzona==""A""]=df_sumFixa$sumFixa1[df_sumFixa$Tzona==""A""]*poraA1"
"0","df_sumFixa$sumFixa1_por[df_sumFixa$Tzona==""B""]=df_sumFixa$sumFixa1[df_sumFixa$Tzona==""B""]*poraB1"
"0","df_sumFixa$sumFixa1_por[df_sumFixa$Tzona==""C""]=df_sumFixa$sumFixa1[df_sumFixa$Tzona==""C""]*poraC1"
"0",""
"0","df_sumFixa$sumFixa2_por[df_sumFixa$Tzona==""A""]=df_sumFixa$sumFixa2[df_sumFixa$Tzona==""A""]*poraA2"
"0","df_sumFixa$sumFixa2_por[df_sumFixa$Tzona==""B""]=df_sumFixa$sumFixa2[df_sumFixa$Tzona==""B""]*poraB2"
"0","df_sumFixa$sumFixa2_por[df_sumFixa$Tzona==""C""]=df_sumFixa$sumFixa2[df_sumFixa$Tzona==""C""]*poraC2"
"0",""
"0","df_sumFixa$sumFixa3_por[df_sumFixa$Tzona==""A""]=df_sumFixa$sumFixa3[df_sumFixa$Tzona==""A""]*poraA3"
"0","df_sumFixa$sumFixa3_por[df_sumFixa$Tzona==""B""]=df_sumFixa$sumFixa3[df_sumFixa$Tzona==""B""]*poraB3"
"0","df_sumFixa$sumFixa3_por[df_sumFixa$Tzona==""C""]=df_sumFixa$sumFixa3[df_sumFixa$Tzona==""C""]*poraC3"
"0",""
"0","df_sumFixa$sumFixa4_por[df_sumFixa$Tzona==""A""]=df_sumFixa$sumFixa4[df_sumFixa$Tzona==""A""]*poraA4"
"0","df_sumFixa$sumFixa4_por[df_sumFixa$Tzona==""B""]=df_sumFixa$sumFixa4[df_sumFixa$Tzona==""B""]*poraB4"
"0","df_sumFixa$sumFixa4_por[df_sumFixa$Tzona==""C""]=df_sumFixa$sumFixa4[df_sumFixa$Tzona==""C""]*poraC4"
"0",""
"0",""
"0","basecompleta$sumFixa1[is.na(basecompleta$sumFixa1)]<-0"
"0","basecompleta$sumFixa2[is.na(basecompleta$sumFixa2)]<-0"
"0","basecompleta$sumFixa3[is.na(basecompleta$sumFixa3)]<-0"
"0","basecompleta$sumFixa4[is.na(basecompleta$sumFixa4)]<-0"
"0",""
"0","df_TotalFixa <- aggregate(cbind(sumFixa1, sumFixa2, sumFixa3, sumFixa4) ~ ID , data = basecompleta, sum, na.rm = TRUE)"
"0",""
"0","# Con respecto al orden funcionamos un poco diferente"
"0","# En el archivo de lectura, una vez leÃ­dos los cuatro archivos, "
"0","#para cada individuo se creavariable que recoja, para cada zona y tarea, "
"0","# cual es el orden en el que aparece por primera vez. "
"0",""
"0","# podemos calcular cuales son los mÃ¡ximos y en el archivo sustituir "
"0","# los valores perdidos por un valor muy superior (999)"
"0",""
"0",""
"0","## Creamos un DF con el mÃ­nimo valor para cada zona, es cuando aparece por primera vez:"
"0","basecompleta$ordenT1[is.na(basecompleta$ordenT1)]<-999"
"0","basecompleta$ordenT2[is.na(basecompleta$ordenT2)]<-999"
"0","basecompleta$ordenT3[is.na(basecompleta$ordenT3)]<-999"
"0","basecompleta$ordenT4[is.na(basecompleta$ordenT4)]<-999"
"0",""
"0","df_orden <- aggregate(cbind(ordenT1, ordenT2, ordenT3, ordenT4) ~ (ID + Tzona), "
"0","                      data = basecompleta, min, na.rm = FALSE)"
"0",""
"0","df_orden<-df_orden[order(df_orden$ID),]"
"0",""
"0",""
"0",""
"0",""
"0","# Calculamos el minimo para cada individuo y tarea"
"0","orden_min <- aggregate(cbind(""minT1""=ordenT1, ""minT2""=ordenT2, ""minT3""=ordenT3, ""minT4""=ordenT4) ~ ID , data = df_orden, min, na.rm = TRUE)"
"0","# Calculamos el maximo para cada individo y tarea"
"0","orden_max <- aggregate(cbind(""maxT1""=ordenT1, ""maxT2""=ordenT2, ""maxT3""=ordenT3, ""maxT4""=ordenT4) ~ ID , data = df_orden, max, na.rm = TRUE)"
"0",""
"0",""
"0","#llevamos los datos de minimo y max a la base de orden"
"0","df_orden <- merge(x=df_orden, y=orden_min, by=c(""ID""))"
"0","df_orden <- merge(x=df_orden, y=orden_max, by=c(""ID""))"
"0",""
"0","# Si el valor del orden es igual al mÃ­nimo, el orden es igual a 1, "
"0","# si el orden es igual al mÃ¡ximo es 3 "
"0","# si no es el mÃ­nimo ni el mÃ¡ximo es 2"
"0","df_orden$O1[df_orden$ordenT1==df_orden$minT1]<-1"
"0","df_orden$O1[df_orden$ordenT1==df_orden$maxT1]<-3"
"0","df_orden$O1[(df_orden$ordenT1!=df_orden$maxT1)&(df_orden$ordenT1!=df_orden$minT1)]<-2"
"0",""
"0","df_orden$O2[df_orden$ordenT2==df_orden$minT2]<-1"
"0","df_orden$O2[df_orden$ordenT2==df_orden$maxT2]<-3"
"0","df_orden$O2[(df_orden$ordenT2!=df_orden$maxT2)&(df_orden$ordenT2!=df_orden$minT2)]<-2"
"0",""
"0","df_orden$O3[df_orden$ordenT3==df_orden$minT3]<-1"
"0","df_orden$O3[df_orden$ordenT3==df_orden$maxT3]<-3"
"0","df_orden$O3[(df_orden$ordenT3!=df_orden$maxT3)&(df_orden$ordenT3!=df_orden$minT3)]<-2"
"0",""
"0","df_orden$O4[df_orden$ordenT4==df_orden$minT4]<-1"
"0",""
"0","basecompleta$TAREA1 <- basecompleta$ordenT1"
"0","basecompleta$TAREA1[as.character(basecompleta$Task1)==""explor""] <- 1"
"0","basecompleta$TAREA1[as.character(basecompleta$Task1)==""search""] <- 2"
"0","basecompleta$TAREA1[as.character(basecompleta$Task1)==""purchase""] <- 3"
"0","basecompleta$TAREA1[as.character(basecompleta$Task1)==""post""] <- 4"
"0",""
"0",""
"0","basecompleta$TAREA2 <- basecompleta$ordenT2"
"0","basecompleta$TAREA2[as.character(basecompleta$Task2)==""explor""] <- 1"
"0","basecompleta$TAREA2[as.character(basecompleta$Task2)==""search""] <- 2"
"0","basecompleta$TAREA2[as.character(basecompleta$Task2)==""purchase""] <- 3"
"0","basecompleta$TAREA3[as.character(basecompleta$Task3)==""post""] <- 4"
"0",""
"0","basecompleta$TAREA4 <- basecompleta$ordenT4"
"0","basecompleta$TAREA4[as.character(basecompleta$Task4)==""explor""] <- 1"
"0","basecompleta$TAREA4[as.character(basecompleta$Task4)==""search""] <- 2"
"0","basecompleta$TAREA4[as.character(basecompleta$Task4)==""purchase""] <- 3"
"0","basecompleta$TAREA4[as.character(basecompleta$Task4)==""post""] <- 4"
"0",""
"0","df_task<- aggregate(cbind(TAREA1, TAREA2, TAREA3, TAREA4) ~ ID + Tzona, data = basecompleta, FUN=mean)"
"0",""
"0",""
"0","FIXA<- data.frame(df_task, df_fixa[7:10], df_sumFixa[7:10],df_orden[15:18])"
"0",""
"0","# base df_TotalFixa"
"0","df_TotalFixa$ID <- factor(df_TotalFixa$ID)"
"0",""
"0","TotalFixa_long <- gather(df_TotalFixa, category, totalFixa, sumFixa1:sumFixa4)"
"0","TotalFixa_long$category_rec[TotalFixa_long$category == ""sumFixa1""] <- ""1"""
"0","TotalFixa_long$category_rec[TotalFixa_long$category == ""sumFixa2""] <- ""2"""
"0","TotalFixa_long$category_rec[TotalFixa_long$category == ""sumFixa3""] <- ""3"""
"0","TotalFixa_long$category_rec[TotalFixa_long$category == ""sumFixa4""] <- ""4"""
"0",""
"0",""
"0","## HACEMOS LA BASE PARA LA ZONA A"
"0",""
"0","zonaA <- FIXA[FIXA$Tzona==""A"",]"
"0","LongDat$ID <- factor(LongDat$ID)"
"0",""
"0","zonaA_long$category_rec[zonaA_long$category == ""sumFixa1_por""] <- ""1"""
"0","zonaA_long$category_rec[zonaA_long$category == ""sumFixa2_por""] <- ""2"""
"0","zonaA_long$category_rec[zonaA_long$category == ""sumFixa3_por""] <- ""3"""
"0",""
"0","LongDat <- merge(x=LongDat, y=zonaA_long[,c(1,16,18)], by=c(""ID"", ""Task"" ))"
"0",""
"0","zonaA_orlong$category_rec[zonaA_orlong$category == ""O1""] <- ""1"""
"0","zonaA_orlong$category_rec[zonaA_orlong$category == ""O2""] <- ""2"""
"0","zonaA_orlong$category_rec[zonaA_orlong$category == ""O3""] <- ""3"""
"0","zonaA_orlong$Task<- zonaA_orlong$category_rec"
"0",""
"0","LongDat <- merge(x=LongDat, y=zonaA_orlong[,c(1,16,18)], by=c(""ID"", ""Task"" ))"
"0",""
"0","zonaB <- FIXA[FIXA$Tzona==""B"",]"
"0","zonaB$ID <- factor(zonaB$ID)"
"0","zonaB_long <- gather(zonaB, category, fijacZonaB, sumFixa1_por:sumFixa4_por)"
"0","zonaB_long$category_rec[zonaB_long$category == ""sumFixa3_por""] <- ""3"""
"0","zonaB_long$category_rec[zonaB_long$category == ""sumFixa4_por""] <- ""4"""
"0","zonaB_long$Task<- zonaB_long$category_rec"
"0",""
"0","LongDat <- merge(x=LongDat, y=zonaB_long[,c(1,16, 18)], by=c(""ID"", ""Task"" ))"
"0",""
"0","#  ORDEN Zona 2"
"0",""
"0","zonaB_orlong <- gather(zonaB, category, ordenZonaB, O1:O4)"
"0",""
"0","zonaB_orlong$category_rec[zonaB_orlong$category == ""O1""] <- ""1"""
"0","zonaB_orlong$category_rec[zonaB_orlong$category == ""O2""] <- ""2"""
"0","zonaB_orlong$category_rec[zonaB_orlong$category == ""O3""] <- ""3"""
"0","zonaB_orlong$category_rec[zonaB_orlong$category == ""O4""] <- ""4"""
"0","zonaB_orlong$Task<- zonaB_orlong$category_rec"
"0",""
"0","LongDat <- merge(x=LongDat, y=zonaB_orlong[,c(1,16, 18)], by=c(""ID"", ""Task"" ))"
"0",""
"0","# PARA LAS FIJACIONES EN LA ZONA 3"
"0",""
"0","zonaC <- FIXA[FIXA$Tzona==""C"",]"
"0","zonaC$ID <- factor(zonaC$ID)"
"0","zonaC_long <- gather(zonaC, category, fijacZonaC, sumFixa1_por:sumFixa4_por)"
"0",""
"0","zonaC_long$category_rec[zonaC_long$category == ""sumFixa1_por""] <- ""1"""
"0","zonaC_long$category_rec[zonaC_long$category == ""sumFixa2_por""] <- ""2"""
"0","zonaC_long$category_rec[zonaC_long$category == ""sumFixa3_por""] <- ""3"""
"0","zonaC_long$category_rec[zonaC_long$category == ""sumFixa4_por""] <- ""4"""
"0","zonaC_long$Task<- zonaC_long$category_rec"
"0",""
"0","LongDat <- merge(x=LongDat, y=zonaC_long[,c(1,16, 18)], by=c(""ID"", ""Task"" ))"
"0",""
"0",""
"0","#  ORDEN Zona 3"
"0",""
"0","zonaC_orlong <- gather(zonaC, category, ordenZonaC, O1:O4)"
"0",""
"0","zonaC_orlong$category_rec[zonaC_orlong$category == ""O1""] <- ""1"""
"0","zonaC_orlong$category_rec[zonaC_orlong$category == ""O2""] <- ""2"""
"0","zonaC_orlong$Task<- zonaC_orlong$category_rec"
"0",""
"0","LongDat <- merge(x=zonaC_orlong[,c(1,16, 18)], y=LongDat, by=c(""ID"", ""Task"" ))"
"0",""
"0","library(xlsx)"
"0","#EntropÃ­a"
"0","entropia<- xlsx::read.xlsx(""data/entropias.xls"",sheetIndex=1, header=FALSE, encoding = ""UTF-8"")"
"0","names(entropia)<-c(""ID"",""entroexp"", ""entrosearch"", ""entropur"", ""entropost"")"
"0","# AÃ±adir a LONGDAT"
"0","entropia_long <- gather(entropia, asignada, entropia, entroexp:entropost)"
"0","entropia_long$Asignada[entropia_long$asignada == ""entroexp""] <- ""explor"""
"0","entropia_long$Asignada[entropia_long$asignada == ""entrosearch""] <- ""search"""
"0","entropia_long$Asignada[entropia_long$asignada == ""entropur""] <- ""purchase"""
"0","entropia_long$Asignada[entropia_long$asignada == ""entropost""] <- ""post"""
"0",""
"0","#Probabilidades"
"0",""
"0","p_explor<- xlsx::read.xlsx(""data/p_explore.xls"",sheetIndex=1, header=TRUE, encoding = ""UTF-8"")"
"0","names(p_explor)<- c(""ID"", ""Ep11"", ""Ep12"", ""Ep13"", ""Ep21"", ""Ep22"", ""Ep23"", ""Ep31"", ""Ep32"", ""Ep33"")"
"0",""
"0",""
"0","p_search<-xlsx::read.xlsx(""data/p_search.xls"",sheetIndex=1, header=TRUE, encoding = ""UTF-8"")"
"0","names(p_search)<- c(""ID"", ""Sp11"", ""Sp12"", ""Sp13"", ""Sp21"", ""Sp22"", ""Sp23"", ""Sp31"", ""Sp32"", ""Sp33"")"
"0",""
"0",""
"0","p_purchase<- xlsx::read.xlsx(""data/p_purchase.xls"",sheetIndex=1, header=TRUE, encoding = ""UTF-8"")"
"0","names(p_purchase)<- c(""ID"", ""Pup11"", ""Pup12"", ""Pup13"", ""Pup21"", ""Pup22"", ""Pup23"", ""Pup31"", ""Pup32"", ""Pup33"")"
"0",""
"0",""
"0","p_post<-xlsx::read.xlsx(""data/p_post.xls"",sheetIndex=1, header=TRUE, encoding = ""UTF-8"")"
"0","names(p_post)<- c(""ID"", ""Post11"", ""Post12"", ""Post13"", ""Post21"", ""Post22"", ""Post23"", ""Post31"", ""Post32"", ""Post33"")"
"0",""
"0","## Primer variable p11"
"0","parea1<-cbind(p_explor[,c(1:5,8)], p_search[,c(2:5,8)], p_purchase[,c(2:5,8)], p_post[,c(2:5,8)])"
"0",""
"0","parea1_11<-parea1[,c(1,2,7,12,17)]"
"0","# AÃ±adir a LONGDAT"
"0","parea1_11_long <- gather(parea1_11, asignada, p11, Ep11:Post11)"
"0","parea1_11_long$Asignada[parea1_11_long$asignada == ""Ep11""] <- ""explor"""
"0","parea1_11_long$Asignada[parea1_11_long$asignada == ""Sp11""] <- ""search"""
"0","parea1_11_long$Asignada[parea1_11_long$asignada == ""Pup11""] <- ""purchase"""
"0","parea1_11_long$Asignada[parea1_11_long$asignada == ""Post11""] <- ""post"""
"0",""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea1_11_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0","## Segunda variable p12"
"0","parea1_12<-parea1[,c(1,3,8,13,18)]"
"0",""
"0","# AÃ±adir a LONGDAT"
"0","parea1_12_long <- gather(parea1_12, asignada, p12, Ep12:Post12)"
"0","parea1_12_long$Asignada[parea1_12_long$asignada == ""Ep12""] <- ""explor"""
"0","parea1_12_long$Asignada[parea1_12_long$asignada == ""Sp12""] <- ""search"""
"0","parea1_12_long$Asignada[parea1_12_long$asignada == ""Pup12""] <- ""purchase"""
"0","parea1_12_long$Asignada[parea1_12_long$asignada == ""Post12""] <- ""post"""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea1_12_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0","## Tercera variable p13"
"0","parea1_13<-parea1[,c(1,4,9,14,19)]"
"0",""
"0","# AÃ±adir a LONGDAT"
"0","parea1_13_long <- gather(parea1_13, asignada, p13, Ep13:Post13)"
"0","parea1_13_long$Asignada[parea1_13_long$asignada == ""Ep13""] <- ""explor"""
"0","parea1_13_long$Asignada[parea1_13_long$asignada == ""Sp13""] <- ""search"""
"0","parea1_13_long$Asignada[parea1_13_long$asignada == ""Pup13""] <- ""purchase"""
"0","parea1_13_long$Asignada[parea1_13_long$asignada == ""Post13""] <- ""post"""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea1_13_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0","## Para el area 2"
"0",""
"0","parea2<-cbind(p_explor[,c(1, 5, 6, 7)], p_search[,c(5:7)], p_purchase[,c(5:7)], p_post[,c(5:7)])"
"0",""
"0","parea2_22<-parea2[,c(1,3, 6, 9,12)]"
"0","# AÃ±adir a LONGDAT"
"0","parea2_22_long <- gather(parea2_22, asignada, p22, Ep22:Post22)"
"0","parea2_22_long$Asignada[parea2_22_long$asignada == ""Ep22""] <- ""explor"""
"0","parea2_22_long$Asignada[parea2_22_long$asignada == ""Sp22""] <- ""search"""
"0","parea2_22_long$Asignada[parea2_22_long$asignada == ""Pup22""] <- ""purchase"""
"0","parea2_22_long$Asignada[parea2_22_long$asignada == ""Post22""] <- ""post"""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea2_22_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0","parea2_21<-parea2[,c(1,2, 5, 8,11)]"
"0","# AÃ±adir a LONGDAT"
"0","parea2_21_long <- gather(parea2_21, asignada, p21, Ep21:Post21)"
"0","parea2_21_long$Asignada[parea2_21_long$asignada == ""Ep21""] <- ""explor"""
"0","parea2_21_long$Asignada[parea2_21_long$asignada == ""Sp21""] <- ""search"""
"0","parea2_21_long$Asignada[parea2_21_long$asignada == ""Pup21""] <- ""purchase"""
"0","parea2_21_long$Asignada[parea2_21_long$asignada == ""Post21""] <- ""post"""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea2_21_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0","parea2_23<-parea2[,c(1,4, 7, 10,13)]"
"0",""
"0","# AÃ±adir a LONGDAT"
"0",""
"0","parea2_23_long <- gather(parea2_23, asignada, p23, Ep23:Post23)"
"0","parea2_23_long$Asignada[parea2_23_long$asignada == ""Ep23""] <- ""explor"""
"0","parea2_23_long$Asignada[parea2_23_long$asignada == ""Sp23""] <- ""search"""
"0","parea2_23_long$Asignada[parea2_23_long$asignada == ""Pup23""] <- ""purchase"""
"0","parea2_23_long$Asignada[parea2_23_long$asignada == ""Post23""] <- ""post"""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea2_23_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0",""
"0","## Para el area 3"
"0",""
"0","parea3<-cbind(p_explor[,c(1, 8:10)], p_search[,c( 8:10)], p_purchase[,c( 8:10)], p_post[,c( 8:10)])"
"0",""
"0","parea3_33<-parea3[,c(1,4, 7, 10,13)]"
"0","# AÃ±adir a LONGDAT"
"0","parea3_33_long <- gather(parea3_33, asignada, p33, Ep33:Post33)"
"0","parea3_33_long$Asignada[parea3_33_long$asignada == ""Ep33""] <- ""explor"""
"0","parea3_33_long$Asignada[parea3_33_long$asignada == ""Sp33""] <- ""search"""
"0","parea3_33_long$Asignada[parea3_33_long$asignada == ""Pup33""] <- ""purchase"""
"0","parea3_33_long$Asignada[parea3_33_long$asignada == ""Post33""] <- ""post"""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea3_33_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0","parea3_31<-parea3[,c(1,2, 5, 8,11)]"
"0","# AÃ±adir a LONGDAT"
"0","parea3_31_long <- gather(parea3_31, asignada, p31, Ep31:Post31)"
"0","parea3_31_long$Asignada[parea3_31_long$asignada == ""Ep31""] <- ""explor"""
"0","parea3_31_long$Asignada[parea3_31_long$asignada == ""Sp31""] <- ""search"""
"0","parea3_31_long$Asignada[parea3_31_long$asignada == ""Pup31""] <- ""purchase"""
"0","parea3_31_long$Asignada[parea3_31_long$asignada == ""Post31""] <- ""post"""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea3_31_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0",""
"0","parea3_32<-parea3[,c(1,3, 6, 9,12)]"
"0","# AÃ±adir a LONGDAT"
"0","parea3_33_long <- gather(parea3_32, asignada, p32, Ep32:Post32)"
"0","parea3_33_long$Asignada[parea3_33_long$asignada == ""Ep32""] <- ""explor"""
"0","parea3_33_long$Asignada[parea3_33_long$asignada == ""Sp32""] <- ""search"""
"0","parea3_33_long$Asignada[parea3_33_long$asignada == ""Pup32""] <- ""purchase"""
"0","parea3_33_long$Asignada[parea3_33_long$asignada == ""Post32""] <- ""post"""
"0",""
"0","LongDat <- merge(x=LongDat, y=parea3_33_long[,c(1,3,4)], by=c(""ID"", ""Asignada"" ), all.x=TRUE)"
"0",""
"0",""
