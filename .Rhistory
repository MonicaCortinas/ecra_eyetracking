LongDat <- merge(x=LongDat, y=parea1_12_long[,c(1,3,4)], by=c("ID", "Asignada" ), all.x=TRUE)
## Tercera variable p13
parea1_13<-parea1[,c(1,4,9,14,19)]
# Añadir a LONGDAT
parea1_13_long <- gather(parea1_13, asignada, p13, Ep13:Post13)
parea1_13_long$Asignada[parea1_13_long$asignada == "Ep13"] <- "explor"
parea1_13_long$Asignada[parea1_13_long$asignada == "Sp13"] <- "search"
parea1_13_long$Asignada[parea1_13_long$asignada == "Pup13"] <- "purchase"
parea1_13_long$Asignada[parea1_13_long$asignada == "Post13"] <- "post"
LongDat <- merge(x=LongDat, y=parea1_13_long[,c(1,3,4)], by=c("ID", "Asignada" ), all.x=TRUE)
## Para el area 2
parea2<-cbind(p_explor[,c(1, 5, 6, 7)], p_search[,c(5:7)], p_purchase[,c(5:7)], p_post[,c(5:7)])
parea2_22<-parea2[,c(1,3, 6, 9,12)]
# Añadir a LONGDAT
parea2_22_long <- gather(parea2_22, asignada, p22, Ep22:Post22)
parea2_22_long$Asignada[parea2_22_long$asignada == "Ep22"] <- "explor"
parea2_22_long$Asignada[parea2_22_long$asignada == "Sp22"] <- "search"
parea2_22_long$Asignada[parea2_22_long$asignada == "Pup22"] <- "purchase"
parea2_22_long$Asignada[parea2_22_long$asignada == "Post22"] <- "post"
LongDat <- merge(x=LongDat, y=parea2_22_long[,c(1,3,4)], by=c("ID", "Asignada" ), all.x=TRUE)
parea2_21<-parea2[,c(1,2, 5, 8,11)]
# Añadir a LONGDAT
parea2_21_long <- gather(parea2_21, asignada, p21, Ep21:Post21)
parea2_21_long$Asignada[parea2_21_long$asignada == "Ep21"] <- "explor"
parea2_21_long$Asignada[parea2_21_long$asignada == "Sp21"] <- "search"
parea2_21_long$Asignada[parea2_21_long$asignada == "Pup21"] <- "purchase"
parea2_21_long$Asignada[parea2_21_long$asignada == "Post21"] <- "post"
LongDat <- merge(x=LongDat, y=parea2_21_long[,c(1,3,4)], by=c("ID", "Asignada" ), all.x=TRUE)
parea2_23<-parea2[,c(1,4, 7, 10,13)]
# Añadir a LONGDAT
parea2_23_long <- gather(parea2_23, asignada, p23, Ep23:Post23)
parea2_23_long$Asignada[parea2_23_long$asignada == "Ep23"] <- "explor"
parea2_23_long$Asignada[parea2_23_long$asignada == "Sp23"] <- "search"
parea2_23_long$Asignada[parea2_23_long$asignada == "Pup23"] <- "purchase"
parea2_23_long$Asignada[parea2_23_long$asignada == "Post23"] <- "post"
LongDat <- merge(x=LongDat, y=parea2_23_long[,c(1,3,4)], by=c("ID", "Asignada" ), all.x=TRUE)
## Para el area 3
parea3<-cbind(p_explor[,c(1, 8:10)], p_search[,c( 8:10)], p_purchase[,c( 8:10)], p_post[,c( 8:10)])
parea3_33<-parea3[,c(1,4, 7, 10,13)]
# Añadir a LONGDAT
parea3_33_long <- gather(parea3_33, asignada, p33, Ep33:Post33)
parea3_33_long$Asignada[parea3_33_long$asignada == "Ep33"] <- "explor"
parea3_33_long$Asignada[parea3_33_long$asignada == "Sp33"] <- "search"
parea3_33_long$Asignada[parea3_33_long$asignada == "Pup33"] <- "purchase"
parea3_33_long$Asignada[parea3_33_long$asignada == "Post33"] <- "post"
LongDat <- merge(x=LongDat, y=parea3_33_long[,c(1,3,4)], by=c("ID", "Asignada" ), all.x=TRUE)
parea3_31<-parea3[,c(1,2, 5, 8,11)]
# Añadir a LONGDAT
parea3_31_long <- gather(parea3_31, asignada, p31, Ep31:Post31)
parea3_31_long$Asignada[parea3_31_long$asignada == "Ep31"] <- "explor"
parea3_31_long$Asignada[parea3_31_long$asignada == "Sp31"] <- "search"
parea3_31_long$Asignada[parea3_31_long$asignada == "Pup31"] <- "purchase"
parea3_31_long$Asignada[parea3_31_long$asignada == "Post31"] <- "post"
LongDat <- merge(x=LongDat, y=parea3_31_long[,c(1,3,4)], by=c("ID", "Asignada" ), all.x=TRUE)
parea3_32<-parea3[,c(1,3, 6, 9,12)]
# Añadir a LONGDAT
parea3_33_long <- gather(parea3_32, asignada, p32, Ep32:Post32)
parea3_33_long$Asignada[parea3_33_long$asignada == "Ep32"] <- "explor"
parea3_33_long$Asignada[parea3_33_long$asignada == "Sp32"] <- "search"
parea3_33_long$Asignada[parea3_33_long$asignada == "Pup32"] <- "purchase"
parea3_33_long$Asignada[parea3_33_long$asignada == "Post32"] <- "post"
LongDat <- merge(x=LongDat, y=parea3_33_long[,c(1,3,4)], by=c("ID", "Asignada" ), all.x=TRUE)
LongDat$weights<-100
fit3A <- glmer(LongDat$p11 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +
(1 | LongDat$dataindividuo.n), weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
fit3B <- glmer(LongDat$p21 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +(1 | LongDat$dataindividuo.n),
weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
fit3C <- glmer(LongDat$p31 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +(1 | LongDat$dataindividuo.n),
weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
## Coeficientes
ctable <- coef(summary(fit3A))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit3A)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit3A)$AICtab
n<- summary(fit3A)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaA<- rbind(coeficientes, ajuste2)
## MODELO B
## Coeficientes
ctable <- coef(summary(fit3B))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
library(tidyverse)
Random<- summary(fit3B)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit3B)$AICtab
n<- summary(fit3B)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaB<- rbind(coeficientes, ajuste2)
ctable <- coef(summary(fit3C))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit3C)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
Ajuste<-summary(fit3C)$AICtab
n<- summary(fit3C)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaC<- rbind(coeficientes, ajuste2)
tablafinal<- cbind(tablaA, tablaB,tablaC)
knitr::kable(tablafinal,format = "html", booktabs = T, digits = c(3,3,3), align=c("r")) %>%
add_header_above(c(" " = 1, "Transitions Area A (Header) -> Area A " = 3, "Transitions Area B (Menu) -> Area A " = 3, "Transitions Area C (Products) -> Area A " = 3)) %>%
kable_styling(latex_options = c("repeat_header","HOLD_position","scale_down"), position='float_right') %>%
group_rows("Task (base exploration)", 2, 4) %>%
group_rows("Category (base sport shoes)", 5, 7) %>%
group_rows("Random part", 11, 13) %>%
group_rows("Fit", 14, 17) %>%
column_spec(2:9, width = "4.2em") %>%
landscape() %>%
footnote(general = "Logistic link, optimizer BOBYQA",
general_title = "Note: ",
footnote_as_chunk = T)
## MODELO A
## Coeficientes
ctable <- coef(summary(fit4A))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit4A)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit4A)$AICtab
n<- summary(fit4A)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaA<- rbind(coeficientes, ajuste2)
## MODELO B
## Coeficientes
ctable <- coef(summary(fit4B))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit4B)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit4B)$AICtab
n<- summary(fit4B)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaB<- rbind(coeficientes, ajuste2)
## MODELO C
## Coeficientes
ctable <- coef(summary(fit4C))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit4C)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit4C)$AICtab
n<- summary(fit4C)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaC<- rbind(coeficientes, ajuste2)
tablafinal<- cbind(tablaA, tablaB,tablaC)
library(kableExtra)
knitr::kable(tablafinal,format = "latex", longtable = T, booktabs = T, digits = c(3,3,3), align=c("r")) %>%
add_header_above(c(" " = 1, "Area B (Menu) -> Area B" = 3, "Transitions Area A (Header) -> Area B  " = 3, "Transitions Area C (Products) -> Area B " = 3)) %>%
kable_styling(latex_options = c("repeat_header","HOLD_position","scale_down"), position='float_right') %>%
group_rows("Task (base exploration)", 2, 4) %>%
group_rows("Category (base sport shoes)", 5, 7) %>%
group_rows("Random part", 11, 13) %>%
group_rows("Fit", 14, 17) %>%
column_spec(2:9, width = "4.2em") %>%
landscape() %>%
footnote(general = "Logistic link, optimizer BOBYQA",
general_title = "Note: ",
footnote_as_chunk = T)
LongDat$weights<-100
## TABLA 4B MODELO A
LongDat$weights<-100
fit4A <- glmer(LongDat$p22 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +
(1 | LongDat$dataindividuo.n), weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
fit4B <- glmer(LongDat$p12 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +(1 | LongDat$dataindividuo.n),
weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
fit4C <- glmer(LongDat$p32 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +(1 | LongDat$dataindividuo.n),
weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
## Coeficientes
ctable <- coef(summary(fit4A))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit4A)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit4A)$AICtab
n<- summary(fit4A)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaA<- rbind(coeficientes, ajuste2)
## MODELO B
## Coeficientes
ctable <- coef(summary(fit4B))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit4B)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit4B)$AICtab
n<- summary(fit4B)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaB<- rbind(coeficientes, ajuste2)
## MODELO C
## Coeficientes
ctable <- coef(summary(fit4C))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "After Sale",
"Mobile phones", "Ball-point pens", "Hard disks", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit4C)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit4C)$AICtab
n<- summary(fit4C)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaC<- rbind(coeficientes, ajuste2)
tablafinal<- cbind(tablaA, tablaB,tablaC)
library(kableExtra)
knitr::kable(tablafinal,format = "latex", longtable = T, booktabs = T, digits = c(3,3,3), align=c("r")) %>%
add_header_above(c(" " = 1, "Area B (Menu) -> Area B" = 3, "Transitions Area A (Header) -> Area B  " = 3, "Transitions Area C (Products) -> Area B " = 3)) %>%
kable_styling(latex_options = c("repeat_header","HOLD_position","scale_down"), position='float_right') %>%
group_rows("Task (base exploration)", 2, 4) %>%
group_rows("Category (base sport shoes)", 5, 7) %>%
group_rows("Random part", 11, 13) %>%
group_rows("Fit", 14, 17) %>%
column_spec(2:9, width = "4.2em") %>%
landscape() %>%
footnote(general = "Logistic link, optimizer BOBYQA",
general_title = "Note: ",
footnote_as_chunk = T)
knitr::kable(tablafinal,format = "html", longtable = T, booktabs = T, digits = c(3,3,3), align=c("r")) %>%
add_header_above(c(" " = 1, "Area B (Menu) -> Area B" = 3, "Transitions Area A (Header) -> Area B  " = 3, "Transitions Area C (Products) -> Area B " = 3)) %>%
kable_styling(latex_options = c("repeat_header","HOLD_position","scale_down"), position='float_right') %>%
group_rows("Task (base exploration)", 2, 4) %>%
group_rows("Category (base sport shoes)", 5, 7) %>%
group_rows("Random part", 11, 13) %>%
group_rows("Fit", 14, 17) %>%
column_spec(2:9, width = "4.2em") %>%
landscape() %>%
footnote(general = "Logistic link, optimizer BOBYQA",
general_title = "Note: ",
footnote_as_chunk = T)
LongDat$weights<-100
fit5A <- glmer(LongDat$p33 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +
(1 | LongDat$dataindividuo.n), weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
fit5B <- glmer(LongDat$p13 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +(1 | LongDat$dataindividuo.n),
weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
fit5C <- glmer(LongDat$p23 ~ LongDat$Asignada+LongDat$category+LongDat$IMPGlobal+
LongDat$busca+LongDat$compra +(1 | LongDat$dataindividuo.n),
weights=LongDat$weights, family = binomial, control = glmerControl(optimizer = "bobyqa"),
nAGQ = 10)
## MODELO A
## Coeficientes
ctable <- coef(summary(fit5A))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "PostPurchase",
"Smartphones", "Pens", "HDs", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit5A)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit5A)$AICtab
n<- summary(fit5A)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaA<- rbind(coeficientes, ajuste2)
## MODELO B
## Coeficientes
ctable <- coef(summary(fit5B))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "PostPurchase",
"Smartphones", "Pens", "HDs", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit5B)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit5B)$AICtab
n<- summary(fit5B)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaB<- rbind(coeficientes, ajuste2)
## MODELO C
## Coeficientes
ctable <- coef(summary(fit5C))
row.names(ctable)<- c("Intercept", "Search", "Purchase", "PostPurchase",
"Smartphones", "Pens", "HDs", "Involvement", "Search Online", "Purchase Online")
coeffpart<-ctable[,c(1:2,4)]
coeffpart<-format(round(coeffpart, 3), nsmall = 3)
## Parte random del modelo
library(tidyverse)
Random<- summary(fit5C)$varcor
rand2<-as.data.frame(Random)
names(rand2)<-c("Group", "var1", "var2","Variance","Std.Dev.")
randompart<-rand2[,c(4,5)]
randompart<- format(round(randompart, 3), nsmall = 3)
r<-rbind(c("Variance", "Std.Dev."), as.character(randompart[,1]),as.character(randompart[,2]))
r2<- cbind(r," "=c(" ", " "))
row.names(r2)<-c(" ", "Subject", "Residual")
coeficientes<- rbind(coeffpart, r2)
# Ajuste del modelo
Ajuste<-summary(fit5C)$AICtab
n<- summary(fit5C)$ngrps
ajusteb<-as.data.frame(Ajuste[c(1:2,5)])
ajusteb<- rbind(ajusteb,n)
row.names(ajusteb)<- c("AIC", "BIC", "Residual DF", "Subjects")
ajusteb<- format(round(ajusteb, 3), nsmall = 3)
ajuste2<- cbind(as.character(ajusteb[,1])," "=c(" "," "," "," ")," "=c(" "," "," "," "))
row.names(ajuste2)<- c("AIC", "BIC", "Residual DF", "Subjects")
names(ajuste2)<-names(coeffpart)
tablaC<- rbind(coeficientes, ajuste2)
tablafinal<- cbind(tablaA, tablaB,tablaC)
library(kableExtra)
knitr::kable(tablafinal,format = "html", longtable = T, booktabs = T, digits = c(3,3,3), align=c("r")) %>%
add_header_above(c(" " = 1, "Transitions Area C (Products) -> Area C" = 3, "Transitions Area A (Header) -> Area C" = 3, "Transitions Area B (Menu) -> Area C" = 3)) %>%
kable_styling(latex_options = c("repeat_header","HOLD_position","scale_down"), position='float_right') %>%
group_rows("Task", 2, 4) %>%
group_rows("Category", 5, 7) %>%
group_rows("Random part", 11, 13) %>%
group_rows("Fit", 14, 17) %>%
column_spec(2:9, width = "4.2em") %>%
landscape() %>%
footnote(general = "Logistic link, optimizer BOBYQA",
general_title = "Note: ",
footnote_as_chunk = T)
